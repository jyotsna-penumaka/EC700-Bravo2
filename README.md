# EC700-Bravo2

This project involves developing a Linux Security Module (LSM) to prevent the execution of binaries based on certain attributes. When an executable is opened, the LSM `checksig` will check if there is a `user.sig` attribute in the binary. It can also check if this attribute matches a previously defined value, in this case `Jyotsna`.  

## Build Instructions

We only tested this on Linux Kernel 5.10.27, x86-64 architecture. We originally targetted OpenWrt OS, but [OpenWrt build process can overwrite kernel config.](http://trac.gateworks.com/wiki/OpenWrt/kernelconfig)  
Instead, follow the [OpenWrt build image instructions](https://openwrt.org/docs/guide-developer/quickstart-build-images) but do development in the target Linux kernel, and avoid doing `make menuconfig` at OpenWrt directory after first time.  

```bash
sudo apt update
git clone https://git.openwrt.org/openwrt/openwrt.git
cd openwrt
./scripts/feeds update -a
./scripts/feeds install -a
make menuconfig
```
Configure options in menuconfig. You need to change target to x86-64, generic x64.  
```bash
make kernel_menuconfig
```
This is configuring the kernel. The config file will be stored in `openwrt/target/linux/x86/config-5.10`  
Here you can go to `Security` then enable different security models. You can select the LSM from there.  
You should also increase the size of the root file system to be 200MB to accomodate development.  

```bash
make -j24 # if this fails, make -j1 V=s
```

The resulting images generated by OpenWrt are in `openwrt/targets/x86/64/openwrt-x86-64-generic-ext4-combined-efi.vdi` as well as other image formats.  
The resulting kernel `bzImage` will be in `openwrt/build_dir/target-x86_64_musl/linux-x86_64/linux-5.10.27/arch/x86_64/boot`.
